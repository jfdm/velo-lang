\PassOptionsToPackage{x11names}{xcolor}
\documentclass[%
final,%
%draft, % note that the orcid.pdf logo is not included with draft mode
a4paper,
UKenglish,
cleveref,
autoref,
thm-restate,
anonymous,
pdfa
]{oasics-v2021}

\usepackage{relsize}

\usepackage{tikz}
\usetikzlibrary{shapes.geometric}

\usepackage{idris2}
\usepackage{catchfilebetweentags}
\input{robust-catch}

\usepackage{acronym}
\usepackage{xspace}
\usepackage[todonotes={obeyFinal},commandnameprefix=always]{changes}
%\usepackage{fancyvrb}
\usepackage{jfdm-plt}
\usepackage{velo}

\setuptodonotes{inline}

\pdfoutput=1
\hideOASIcs %uncomment to remove references to OASIcs series (logo, DOI, ...), e.g. when preparing a pre-final version to be uploaded to arXiv or another public repository

%\graphicspath{{./graphics/}}%helpful if your graphic files are in another directory

\bibliographystyle{plainurl}% the mandatory bibstyle

\title{Type Theory as a Language Workbench} %TODO Please add

\author
{Jan {de Muijnck-Hughes}}
{University of Glasgow, UK}
{Jan.deMuijnck-Hughes@glasgow.ac.uk}
{https://orcid.org/0000-0003-2185-8543}
{} % TODO

\author
{Guillaume Allais}
{University of St Andrews, UK}
{gxa1@st-andrews.ac.uk} % Check
{https://orcid.org/0000-0002-4091-657X} % ORCID
{} % TODO

\author
{Edwin Brady}
{University of St Andrews, UK}
{ecb10@st-andrews.ac.uk} % Check
{https://orcid.org/0000-0002-9734-367X} % ORCID
{} % TODO


\input{./figure/syntax}
\input{./figure/ast}
\input{./preamble}

\begin{document}

%\input{./notations}

\maketitle

% 1. State the problem
% 2. Say why it is an interesting problem
% 3. Say what your solution achieves
% 4. Say what follows from your solution

\begin{abstract}
  Language Workbenches offer language designers an expressive environment in which to create their \acp*{dsl}.
  %
  Similarly, research into mechanised meta-theory has shown how dependently-typed languages provide expressive environments to formalise and study \acsp*{dsl} and their meta-theoretical properties.
  %
  But can we claim that dependently-typed languages qualify as language workbenches?
  %
  We argue yes!


  We have developed an exemplar \acs*{dsl} called \Velo{} that showcases not only dependently-typed techniques to realise and manipulate \acp*{ir}, but that dependently-typed languages make fine language workbenches.
  %
  \Velo{} is a simple verified language with well-typed holes and comes with a complete compiler pipeline: parser, elaborator, \acs*{repl}, evaluator, and compiler passes.
  %
  Specifically, we describe our design choices for well-typed \acs*{ir} design that includes support for well-typed holes, how \acf*{cse} is achieved in a well-typed setting, and how the mechanised type-soundness proof for \Velo{} is the source of the evaluator.
\end{abstract}

%  We also present good programming idioms for working with dependent types.

%  We are planning to showcase dependently typed techniques to implement \& manipulate IRs.
%
%The key components we are planning to treat are:
%
%\begin{itemize}
%\item Efficient de Bruijn representations
%\item Co de Bruijn for CSE
%\item Evaluation as Progress (with computation rules in one separate function)
%\item Well scoped holes
%\item Linear (in number of cases) decidable equality
%\item Compact constant folding
%\item Positive evidence for negative statements
%\item Whole pipeline (parser, elaborator, REPL, evaluator, compiler passes)
%\end{itemize}
%
%Our ongoing work is available at:
%
%\url{https://github.com/jfdm/velo-lang}

\todo{Run spellcheck}
\todo{Use Katla to typeset Idris 2 code}

\section{Introduction}
\label{sec:introduction}

\input{./content/introduction}


\section{Introducing Velo}
\label{sec:velo}

\input{./content/velo-intro}

\section{Language Design}
\label{sec:design}

\input{./content/lang-design}

\input{./content/deBruijn}
\input{./content/well-typed-holes}
\input{./content/compactconstant}


\section{Compiler Passes}
\label{sec:compiler-pass}

\input{./content/cse}

\section{Execution}
\label{sec:semantics}

\input{./content/execution}

%\section{Good Programming Idioms}
%\label{sec:idioms}
%
%We end our tour of \Velo{} by detailing two programming idioms that helped with the reporting of errors, and reasoning about decidable equality of inductive data structures.
%
%\input{./content/positivelynegative}
%\input{./content/efficientdeceq}

\section{Conclusion}
\label{sec:conclusion}

\input{./content/conclusion}

% we have 2 pages of refs for free
\newpage
\bibliography{paper}

%\newpage
%\appendix
%
%\begin{figure}[ht]
%  \centering
%  \input{./figure/syntax}
%  \caption{\label{fig:velo:syntax}\Velo{} Formal Abstract Syntax}
%\end{figure}
%
%\begin{figure}[ht]
%  \centering
%  \input{./figure/statics}
%  \caption{\label{fig:velo:statics}\Velo{} Typing Rules}
%\end{figure}
%
%\begin{figure}[ht]
%  \centering
%  \input{./figure/dynamics-smallstep}
%  \caption{\label{fig:velo:statics}\Velo{} SmallStep Reduction Semantics}
%\end{figure}

\end{document}
